# Курсовой проект "Сервис перевода денег"

## Задание

#### Описание проекта 

Разработать приложение - REST-сервис. Сервис должен предоставить интерфейс для перевода денег с одной карты на другую по заранее описанной спецификации. Заранее подготовленное веб-приложение (FRONT) должно подключаться к разработанному сервису без доработок и использовать его функционал для перевода денег.

#### Требования к приложению

- Сервис должен предоставлять REST интерфейс для интеграции с FRONT
- Сервис должны реализовывать все методы перевода с одной банковской карты на другую описанные в протоколе https://github.com/netology-code/jd-homeworks/blob/master/diploma/MoneyTransferServiceSpecification.yaml
- Все изменения должны записываться в файл (лог переводов в произвольном формате с указанием даты, времени, карта с которой было списание, карта зачисления, сумма, комиссия, результат операции если был)

#### Требования в реализации

- Приложение разработано с использованием Spring Boot
- Использован сборщик пакетов gradle/maven
- Для запуска используется docker, docker-compose
- Код размещен на github
- Код покрыт unit тестами с использованием mockito
- Добавлены интеграционные тесты с использованием testcontainers
- Шаги реализации:
- Изучить протокол получения и отправки сообщений
- Нарисовать схему приложений
- Описать архитектуру приложения (где хранятся настройки, описать формат хранения данных о картах)
- Создать репозиторий проекта на github
- Протестировать приложение с помощью curl/postman
- Написать dockerfile и создать контейнер
- Написать docker-compose скрипт для запуска FRONT и написанного REST-SERVICE
- Протестировать запуск с помощью docker-compose и интеграцию с FRONT
- Написать README.md к проекту, где описать команду запуска, порт и примеры запросов.
- Отправить на проверку

#### Описание интеграции с FRONT
FRONT доступен по адресу https://github.com/serp-ya/card-transfer, можно выкачать репозиторий и запустить nodejs приложение локально 
(в описании репозитория фронта добавлена информация как запустить) или использовать уже развернутое демо приложение по адресу https://serp-ya.github.io/card-transfer/ (тогда ваш api должен быть запущен по адресу http://localhost:5500/).
> Весь api фронта был описан в соответствии yaml (https://github.com/netology-code/jd-homeworks/blob/master/diploma/MoneyTransferServiceSpecification.yaml)
файла по спецификации openapi (подробнее тут https://swagger.io/specification/ и тут https://starkovden.github.io/introduction-openapi-and-swagger.html)

## Решение

Приложение предоставляет простой сервис перевода денег с карты на карту.

### Запуск

Для запуска приложения с использованием Docker необходимо:

1. склонировать репозиторий,
2. в директории модуля `Server` выролнить команды `mvn clean`

3. затем по очереди `mvn package -Dmaven.test.skip`,
4. `docker compose build`.

После завершения монтирования образов, запуск приложения осуществляется командой `docker compose up`.

Проект будет доступен из браузера по ссылке `http://localhost:3000/`.

В файле `.env` содержатся доступные настройки:

Данные о картах хранятся в файле `cards.json`.
Каждая строка содержит строго 1 карту в формате json:

При отсутствии доступных карт приложение запустится, но любая попытка перевода будет безуспешной.

Логгирование работы сервиса выполняется в файл `log.txt`.

Место хранения файлов приложения на локальной машине может быть изменено в файле настроек `.env`.

### Описание

Проект состоит из веб интерфейса и сервера для перевода денег с карты на карту.

Описание веб интерфейса можно посмотреть [по ссылке](./WebClient/card-transfer-master/README.md).

Сервер обрабатывает запросы от клиента, выполненные в соответствии с протоколом
[https://github.com/netology-code/jd-homeworks/blob/master/diploma/MoneyTransferServiceSpecification.yaml](https://github.com/netology-code/jd-homeworks/blob/master/diploma/MoneyTransferServiceSpecification.yaml)
.
Проверяются валидации:

* Номер карты - обязательное, минимум 16 знаков
* ММ/ГГ - обязательное, минимум 5 знаков
* CVC - обязательное, минимум 3 знака
* Сумма перевода - обязательное, не может быть равное или меньше 0
* Номер карты отправителя и карты получателя не должны совпадать
* У карты получателя должен быть счет в валюте перевода
* На счете отправителя достаточно средств для выполения операции

### Обработка запросов

Эндпоинты:

* `/transfer` - принимает объект и возвращает номер операции при успешном выполнении
* `/confirmOperation` - принимает объект с кодом верификации и возвращает номер операции при успешном выполнении

Если какой-либо из указанных валидаций не соблюдается, то выбрасывается исключение и клиенту возвращается ответ с
ошибкой.

При успешном завершении, отображается соответствующее модальное окно и поля формы очищаются.
